Apollo Cyber R\-T framework comes with a collection of useful tools for daily development, including one visualization tool cyber\-\_\-visualizer and two command line tools cyber\-\_\-monitor and cyber\-\_\-recorder.

{\itshape Note\-: apollo docker environment is required to use the tools, please follow apollo wiki to enter docker}

All the tools from Apollo Cyber R\-T rely on Apollo Cyber R\-T library, so you must source the setup.\-bash file for environment setup before using any Apollo Cyber R\-T tools, shown as below\-:

```bash username\-:$\sim$\$\-: source /your-\/path-\/to-\/apollo-\/install-\/dir/cyber/setup.bash ```

\subsection*{Cyber\-\_\-visualizer}

\subsubsection*{Install and run}

{\ttfamily cyber\-\_\-visualizer} is a visualization tool for displaying the channel data in Apollo Cyber R\-T.

```bash username\-:$\sim$\$\-: source /your-\/path-\/to-\/apollo-\/install-\/dir/cyber/setup.bash username\-:$\sim$\$\-: cyber\-\_\-visualizer ```

\subsubsection*{Interacting with cyber\-\_\-visualizer}


\begin{DoxyItemize}
\item After launching cyber\-\_\-visualizer, you will see the following interface\-:


\item When data flow through channels in Apollo Cyber R\-T, the list of all channels are displayed under {\ttfamily Channel\-Names} as seen in the figure below. For example, you can use the record tool(cyber\-\_\-recorder) of Apollo Cyber R\-T to replay data from another terminal, then {\ttfamily cyber\-\_\-visualizer} will receive information of all active channels(from replay data) and display it.


\item By clicking on options in toolbar, you can enable reference grid, display point clouds, add images, or display multiple camera's data at the same time. If you have {\ttfamily Show Grid} option enabled, you can set the color of the grid by double-\/clicking the {\ttfamily Color} item of the {\ttfamily Grid} list below {\ttfamily Channel\-Names}. The default color is gray. You can also edit the value of {\ttfamily Cellcount} to adjust the number of cells in the grid. As for a point cloud or an image, you can select the source channel through its {\ttfamily Channel\-Name} sub-\/item, and {\ttfamily Action} sub-\/item to play or stop the data from the corresponding channel. As shown in figure below, three cameras' channel data on the buttom sections and one point cloud channel data on the top section are displayed simultaneously. \begin{DoxyVerb}![visualization](images/cyber_visualizer3.png)
\end{DoxyVerb}

\item To adjust the virtual camera in the 3\-D point cloud scene, you can right click on the point cloud display section. A dialog box will pop up as shown in figure below.



The point cloud scene supports two types of cameras\-: Free and Target.(select Type from pop up dialog above)
\begin{DoxyItemize}
\item {\bfseries Free type Camera}\-: For this type of camera in the point cloud scene, you can change the pose of the camera by holding down either left or right mouse button and move it. To change the pitch of camera, you can scroll the mouse wheel.
\item {\bfseries Target type Camera}\-: For this type of camera in the point cloud scene, to change the camera's viewing angle, you can hold down the left mouse button and then move it. To change the distance of the camera to the observed point (the default observation point is the coordinate system origin (0, 0,0)), you can scroll the mouse wheel.
\end{DoxyItemize}

You can also modify the camera information directly in the dialog box to change the camera's observation status in the point cloud scene. And the \char`\"{}\-Step\char`\"{} item is the step value from the dialog box.

Place the mouse on the image of the camera channel, you can double-\/click the left button to highlight the corresponding data channel on the left menu bar. Right click on the image to bring up menu for deleting the camera channel.

Play and Pause buttons\-: when clicking the {\ttfamily Play} button, all channels will be showed. While when clicking the {\ttfamily Pause} button, all channels will stop showing on the tool.
\end{DoxyItemize}

\subsection*{Cyber\-\_\-monitor}

\subsubsection*{Install and run}

The command line tool {\ttfamily cyber\-\_\-monitor} provides a clear view of the list of real time channel information Apollo Cyber R\-T in the terminal.

```bash username\-:$\sim$\$\-: source /your-\/path-\/to-\/apollo-\/install-\/dir/cyber/setup.bash username\-:$\sim$\$\-: cyber\-\_\-monitor ```

\subsubsection*{Useful commands}

\paragraph*{Display help information}

Use the -\/h option to get help for cyber\-\_\-monitor

```bash username\-:$\sim$\$\-: cyber\-\_\-monitor -\/h ```

\paragraph*{Specify the channel}

With the -\/c option, you can have cyber\-\_\-monitor to monitor only a specified channel, such as\-:

```bash username\-:$\sim$\$\-: cyber\-\_\-monitor -\/c Channel\-Name ```

\subsection*{Get familiar with U\-I of cyber\-\_\-monitor}

After launching the command line tool, you will notice it is similar to cyber\-\_\-visualizer. It automatically collects the information of all the channels through the topology and displays them in two columns (channel name, channel data type).

The default display for channel information is in red. However, if there is data flowing through the a channel, the corresponding line of the channel is displayed in green. As shown in the image below\-:



\subsubsection*{Interacting with cyber\-\_\-monitor}

\paragraph*{Common commands}

``` E\-S\-C $\vert$ q key -\/--- Exit Backspace -\/--- Back h $\vert$ H -\/--- Show help page ```

\paragraph*{Common command for topology and channel}

``` Page\-Down $\vert$ Ctrl+d --- Next Page\-Up $\vert$ Ctrl+u --- Previous Up, down or w, s keys -\/--- Move the current highlight line up and down Right arrow or d key -\/--- Enter highlight line, display highlighted line data in detail Left arrow or a key -\/-\/-\/--- Return to the previous layer from the current Enter key -\/-\/--- Same as d key ```

\paragraph*{Commands only for topology}

``` f $\vert$ F -\/-\/--- Display frame rate t $\vert$ T -\/-\/--- Display channel message type Space -\/-\/--- Close$\vert$\-Open channel (only valid for channels with data arrival; yellow color after channel is closed) ```

\paragraph*{Commands only for channel}

``` i $\vert$ I -\/-\/--- Display channel Reader and Writer information b $\vert$ B -\/-\/-\/--- Display channel message content ```

\paragraph*{View the repeated data field in a channel}

``` n $\vert$ N -\/--- Repeat the next data in the domain m $\vert$ M -\/--- Repeat one data on the domain ```

\subsection*{Cyber\-\_\-recorder}

{\ttfamily cyber\-\_\-recorder} is a record/playback tool provided by Apollo Cyber R\-T. It provides many useful functions, including recording a record file, playing back a record file, splitting a record file, checking the information of record file and etc.

\subsubsection*{Install and run}

Launch cyber\-\_\-recorder\-:

```bash \$ source /your-\/path-\/to-\/apollo-\/install-\/dir/cyber/setup.bash \$ cyber\-\_\-recorder usage\-: cyber\-\_\-recorder $<$command$>$$>$ \mbox{[}$<$args$>$\mbox{]} The cyber\-\_\-recorder commands are\-: info Show infomation of an exist record. play Play an exist record. record Record same topic. split Split an exist record. recover Recover an exist record. ```

\subsubsection*{Commands of cyber\-\_\-recorder}


\begin{DoxyItemize}
\item To view the information of a record file\-:
\end{DoxyItemize}

``` cyber\-\_\-recorder info -\/h usage\-: cyber\-\_\-recorder info \mbox{[}options\mbox{]} -\/h, --help show help message ```


\begin{DoxyItemize}
\item To record a record file
\end{DoxyItemize}

``` \$ cyber\-\_\-recorder record -\/h usage\-: cyber\-\_\-recorder record \mbox{[}options\mbox{]} -\/o, --output $<$file$>$ output record file -\/a, --all all channels -\/c, --channel $<$name$>$ channel name -\/i, --segment-\/interval $<$seconds$>$ record segmented every n second(s) -\/m, --segment-\/size $<$\-M\-B$>$ record segmented every n megabyte(s) -\/h, --help show help message

```


\begin{DoxyItemize}
\item To play back a record file\-:
\end{DoxyItemize}

``` \$ cyber\-\_\-recorder play -\/h usage\-: cyber\-\_\-recorder play \mbox{[}options\mbox{]} -\/f, --file $<$file$>$ input record file -\/c, --white-\/channel $<$name$>$ only play the specified channel -\/l, --loop loop play -\/r, --rate $<$1.\-0$>$ multiply the play rate by F\-A\-C\-T\-O\-R -\/b, --begin $<$2018-\/07-\/01 00\-:00\-:00$>$ play the record begin at -\/e, --end $<$2018-\/07-\/01 00\-:01\-:00$>$ play the record end at -\/s, --start $<$seconds$>$ play started at n seconds -\/d, --delay $<$seconds$>$ play delayed n seconds -\/p, --preload $<$seconds$>$ play after trying to preload n second(s) -\/h, --help show help message ```


\begin{DoxyItemize}
\item To split a record file\-:
\end{DoxyItemize}

``` \$ cyber\-\_\-recorder split -\/h usage\-: cyber\-\_\-recorder split \mbox{[}options\mbox{]} -\/f, --file $<$file$>$ input record file -\/o, --output $<$file$>$ output record file -\/a, --all all channels -\/c, --channel $<$name$>$ channel name -\/b, --begin $<$2018-\/07-\/01 00\-:00\-:00$>$ begin at assigned time -\/e, --end $<$2018-\/07-\/01 01\-:00\-:00$>$ end at assigned time ```


\begin{DoxyItemize}
\item To repair a record file\-:
\end{DoxyItemize}

``` \$ cyber\-\_\-recorder recover -\/h usage\-: cyber\-\_\-recorder recover \mbox{[}options\mbox{]} -\/f, --file $<$file$>$ input record file -\/o, --output $<$file$>$ output record file ```

\subsubsection*{Examples of using cyber\-\_\-recorder}

\paragraph*{Check the details of a record file}

``` \$ cyber\-\_\-recorder info demo.\-record record\-\_\-file\-: demo.\-record version\-: 1.\-0 duration\-: 19.\-995227 Seconds begin\-\_\-time\-: 2018-\/04-\/17 06\-:25\-:36 end\-\_\-time\-: 2018-\/04-\/17 06\-:25\-:55 size\-: 28275479 Bytes (26.\-965598 M\-B) is\-\_\-complete\-: true message\-\_\-number\-: 15379 channel\-\_\-number\-: 16 channel\-\_\-info\-: /apollo/localization/pose 2000 messages \-: apollo.\-localization.\-Localization\-Estimate /tf 4000 messages \-: apollo.\-transform.\-Transform\-Stampeds /apollo/control 2000 messages \-: apollo.\-control.\-Control\-Command /apollo/sensor/gnss/odometry 2000 messages \-: apollo.\-localization.\-Gps /apollo/canbus/chassis 2000 messages \-: apollo.\-canbus.\-Chassis /apollo/sensor/gnss/imu 1999 messages \-: apollo.\-drivers.\-gnss.\-Imu /apollo/sensor/gnss/rtk\-\_\-obs 41 messages \-: apollo.\-drivers.\-gnss.\-Epoch\-Observation /apollo/sensor/gnss/ins\-\_\-stat 20 messages \-: apollo.\-drivers.\-gnss.\-Ins\-Stat /apollo/sensor/gnss/best\-\_\-pose 20 messages \-: apollo.\-drivers.\-gnss.\-Gnss\-Best\-Pose /apollo/perception/obstacles 400 messages \-: apollo.\-perception.\-Perception\-Obstacles /apollo/prediction 400 messages \-: apollo.\-prediction.\-Prediction\-Obstacles /apollo/sensor/conti\-\_\-radar 270 messages \-: apollo.\-drivers.\-Conti\-Radar /apollo/planning 200 messages \-: apollo.\-planning.\-A\-D\-C\-Trajectory /apollo/monitor/static\-\_\-info 1 messages \-: apollo.\-data.\-Static\-Info /apollo/sensor/gnss/rtk\-\_\-eph 25 messages \-: apollo.\-drivers.\-gnss.\-Gnss\-Ephemeris /apollo/monitor 3 messages \-: apollo.\-common.\-monitor.\-Monitor\-Message

```

\paragraph*{Record a record file}

``` \$ cyber\-\_\-recorder record -\/a \mbox{[}R\-U\-N\-N\-I\-N\-G\mbox{]} Record \-: total channel num \-: 1 total msg num \-: 5 ... ```

\paragraph*{Replay a record file}

``` \$ cyber\-\_\-recorder play -\/f 20180720202307.\-record file\-: 20180720202307.\-record, chunk\-\_\-number\-: 1, begin\-\_\-time\-: 1532089398663399667, end\-\_\-time\-: 1532089404688079759, message\-\_\-number\-: 75 please wait for loading and playing back record... Hit Ctrl+\-C to stop replay, or Space to pause. \mbox{[}R\-U\-N\-N\-I\-N\-G\mbox{]} Record Time\-: 1532089404.\-688080 Progress\-: 6.\-024680 / 6.\-024680 play finished. file\-: 20180720202307.\-record ```

\subsection*{rosbag\-\_\-to\-\_\-record}

{\ttfamily rosbag\-\_\-to\-\_\-record} is a tool which can convert rosbag to recorder file provided by Apollo Cyber R\-T. Now the tool support following channel\-:

``` /apollo/perception/obstacles /apollo/planning /apollo/prediction /apollo/canbus/chassis /apollo/control /apollo/guardian /apollo/localization/pose /apollo/perception/traffic\-\_\-light /apollo/drive\-\_\-event /apollo/sensor/gnss/odometry /apollo/monitor/static\-\_\-info /apollo/monitor /apollo/canbus/chassis\-\_\-detail /apollo/control/pad /apollo/navigation /apollo/routing\-\_\-request /apollo/routing\-\_\-response /tf /tf\-\_\-static /apollo/sensor/conti\-\_\-radar /apollo/sensor/delphi\-\_\-esr /apollo/sensor/gnss/best\-\_\-pose /apollo/sensor/gnss/imu /apollo/sensor/gnss/ins\-\_\-stat /apollo/sensor/gnss/rtk\-\_\-eph /apollo/sensor/gnss/rtk\-\_\-obs /apollo/sensor/velodyne64/compensator/\-Point\-Cloud2 ```

\subsubsection*{Install and run}

Launch rosbag\-\_\-to\-\_\-record\-:

```bash \$ source /your-\/path-\/to-\/apollo-\/install-\/dir/cyber/setup.bash \$ rosbag\-\_\-to\-\_\-record Usage\-: rosbag\-\_\-to\-\_\-record input.\-bag output.\-record ```

\subsubsection*{Example}

We can convert \href{https://github.com/ApolloAuto/apollo/releases/download/v2.5.0/demo_2.5.bag}{\tt Apollo2.\-5 demo bag} to record file.

```bash \$ rosbag\-\_\-to\-\_\-record demo\-\_\-2.\-5.\-bag demo.\-record record\-\_\-file\-: demo.\-record version\-: 1.\-0 duration\-: 19.\-995227 Seconds begin\-\_\-time\-: 2018-\/04-\/17 06\-:25\-:36 end\-\_\-time\-: 2018-\/04-\/17 06\-:25\-:55 size\-: 28275479 Bytes (26.\-965598 M\-B) is\-\_\-complete\-: true message\-\_\-number\-: 15379 channel\-\_\-number\-: 16 channel\-\_\-info\-: /apollo/localization/pose 2000 messages \-: apollo.\-localization.\-Localization\-Estimate /tf 4000 messages \-: apollo.\-transform.\-Transform\-Stampeds /apollo/control 2000 messages \-: apollo.\-control.\-Control\-Command /apollo/sensor/gnss/odometry 2000 messages \-: apollo.\-localization.\-Gps /apollo/canbus/chassis 2000 messages \-: apollo.\-canbus.\-Chassis /apollo/sensor/gnss/imu 1999 messages \-: apollo.\-drivers.\-gnss.\-Imu /apollo/sensor/gnss/rtk\-\_\-obs 41 messages \-: apollo.\-drivers.\-gnss.\-Epoch\-Observation /apollo/sensor/gnss/ins\-\_\-stat 20 messages \-: apollo.\-drivers.\-gnss.\-Ins\-Stat /apollo/sensor/gnss/best\-\_\-pose 20 messages \-: apollo.\-drivers.\-gnss.\-Gnss\-Best\-Pose /apollo/perception/obstacles 400 messages \-: apollo.\-perception.\-Perception\-Obstacles /apollo/prediction 400 messages \-: apollo.\-prediction.\-Prediction\-Obstacles /apollo/sensor/conti\-\_\-radar 270 messages \-: apollo.\-drivers.\-Conti\-Radar /apollo/planning 200 messages \-: apollo.\-planning.\-A\-D\-C\-Trajectory /apollo/monitor/static\-\_\-info 1 messages \-: apollo.\-data.\-Static\-Info /apollo/sensor/gnss/rtk\-\_\-eph 25 messages \-: apollo.\-drivers.\-gnss.\-Gnss\-Ephemeris /apollo/monitor 3 messages \-: apollo.\-common.\-monitor.\-Monitor\-Message Convertion finished! Took 0.\-505623051 seconds in total. ``` 